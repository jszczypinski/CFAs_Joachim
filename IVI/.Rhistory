BiocManager::install('PCAtools')
if (!requireNamespace('BiocManager', quietly = TRUE))
install.packages('BiocManager')
BiocManager::install('PCAtools')
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DelayedMatrixStats")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DelayedMatrixStats")
library(PCAtools)
install.packages("kableExtra")
library(kableExtra)
install.packages("kableExtra")
install.packages('kableExtra', repos='https://cloud.r-project.org/')
install.packages('kableExtra', repos='https://cran.ma.imperial.ac.uk/')
install.packages("kableExtra")
install.packages("kableExtra")
install.packages("kableExtra")
install.packages("kableExtra")
install.packages("kableExtra")
install.packages("kableExtra".mirror="https://mirrors.nic.cz/R/")
install.packages("kableExtra", mirror="https://mirrors.nic.cz/R/")
install.packages("rlang")
install.packages("kableExtra")
install.packages("kableExtra", dependencies=T)
install.packages("kableExtra")
install.packages(file.choose(), repos=NULL)
library(kableExtra)
install.packages("installr")
library(installr)
updateR()
q()
0.00278429-0.002662
0.00486324 - 0.004665
library(readr)
library(tidyverse)
library(dplyr)
d <- read.csv("GPTS.csv", sep=";", header =T)
setwd("f:/projekty/Joachim/GPTS")
d <- read.csv("GPTS.csv", sep=";", header =T)
View(d)
d <- read.csv("GPTS.csv", sep=",", header =T)
View(d)
View(d)
library(lavaan)
library(lavaanPlot)
View(d)
model = 'reference =~ ď.żPartA_gptsa1 + PartA_gptsa2 +PartA_gptsa3 + PartA_gptsa4 +
PartA_gptsa5 + PartA_gptsa6 + PartA_gptsa7 + PartA_gptsa8
persecutory =~ partB_gptsb1 + partB_gptsb2 + partB_gptsb3 + partB_gptsb4 +
partB_gptsb5 + partB_gptsb6 + partB_gptsb7 + partB_gptsb8 + partB_gptsb9 +
partB_gptsb10
new_fit1 = cfa(new_model, data = BIS_data, estimator = "WLSMV", std.lv=TRUE, missing = "listwise")
fitmeasures(new_fit1,c('chisq.scaled', 'df.scaled', 'chisq.scaling.factor'))
summary(new_fit1,standardized=T, fit.measures = T)
model = 'reference =~ ď.żPartA_gptsa1 + PartA_gptsa2 +PartA_gptsa3 + PartA_gptsa4 +
PartA_gptsa5 + PartA_gptsa6 + PartA_gptsa7 + PartA_gptsa8
persecutory =~ partB_gptsb1 + partB_gptsb2 + partB_gptsb3 + partB_gptsb4 +
partB_gptsb5 + partB_gptsb6 + partB_gptsb7 + partB_gptsb8 + partB_gptsb9 +
partB_gptsb10
new_fit1 = cfa(new_model, data = BIS_data, estimator = "WLSMV", std.lv=TRUE, missing = "listwise")
fitmeasures(new_fit1,c('chisq.scaled', 'df.scaled', 'chisq.scaling.factor'))
summary(new_fit1,standardized=T, fit.measures = T)
model = 'reference =~ ď.żPartA_gptsa1 + PartA_gptsa2 +PartA_gptsa3 + PartA_gptsa4 +
PartA_gptsa5 + PartA_gptsa6 + PartA_gptsa7 + PartA_gptsa8
persecutory =~ partB_gptsb1 + partB_gptsb2 + partB_gptsb3 + partB_gptsb4 +
partB_gptsb5 + partB_gptsb6 + partB_gptsb7 + partB_gptsb8 + partB_gptsb9 +
partB_gptsb10'
model_fit = cfa(model, data = d, estimator = "WLSMV", std.lv=TRUE, missing = "listwise")
model = 'reference =~ ď.żPartA_gptsa1 + PartA_gptsa2 +PartA_gptsa3 + PartA_gptsa4 +
PartA_gptsa5 + PartA_gptsa6 + PartA_gptsa7 + PartA_gptsa8
persecutory =~ partB_gptsb1 + partB_gptsb2 + partB_gptsb3 + partB_gptsb4 +
partB_gptsb5 + partB_gptsb6 + partB_gptsb7 + partB_gptsb8 + partB_gptsb9 +
partB_gpts10'
model_fit = cfa(model, data = d, estimator = "WLSMV", std.lv=TRUE, missing = "listwise")
summary(model_fit,standardized=T, fit.measures = T)
install.packages("lavaanPlot")
colnames(d$ď.żPartA_gptsa1) = 'PartA_gptsa1'
colnames(d[1,1]) = 'PartA_gptsa1'
colnames(d[1]) = 'PartA_gptsa1'
d
View(d)
colnames(d)[1] = 'PartA_gptsa1'
d[10,10]
d[10]
d[,10]
d[10,]
model = 'reference =~ PartA_gptsa1 + PartA_gptsa2 +PartA_gptsa3 + PartA_gptsa4 +
PartA_gptsa5 + PartA_gptsa6 + PartA_gptsa7 + PartA_gptsa8
persecutory =~ partB_gptsb1 + partB_gptsb2 + partB_gptsb3 + partB_gptsb4 +
partB_gptsb5 + partB_gptsb6 + partB_gptsb7 + partB_gptsb8 + partB_gptsb9 +
partB_gpts10'
colnames(d)[1] = 'PartA_gptsa1'
model_fit = cfa(model, data = d, estimator = "WLSMV", std.lv=TRUE, missing = "listwise")
fitmeasures(new_fit1,c('chisq.scaled', 'df.scaled', 'chisq.scaling.factor'))
summary(model_fit,standardized=T, fit.measures = T)
d2 = subset(d, badanie ==2)
d2
d3 = subset(d, badanie ==3)
d3
d1 = subset(d, badanie ==1)
View(d)
d2 %>%
mutate_at(vars(1:18),
~factor(recode(.,
"1"=0,
"2 "=1,
"3"=2,
"4"=3,
"5"=4)),ordered=T)
library(dplyr)
d2 %>%
mutate_at(vars(1:18),
~factor(recode(.,
"1"=0,
"2 "=1,
"3"=2,
"4"=3,
"5"=4)),ordered=T)
d3 %>%
mutate_at(vars(1:18),
~factor(recode(.,
"1"=0,
"2 "=1,
"3"=2,
"4"=3,
"5"=4)),ordered=T)
d = cbind(d1,d2)
d = rbind(d1,d2)
d = rbind(d,d3)
model = 'reference =~ PartA_gptsa1 + PartA_gptsa2 +PartA_gptsa3 + PartA_gptsa4 +
PartA_gptsa5 + PartA_gptsa6 + PartA_gptsa7 + PartA_gptsa8
persecutory =~ partB_gptsb1 + partB_gptsb2 + partB_gptsb3 + partB_gptsb4 +
partB_gptsb5 + partB_gptsb6 + partB_gptsb7 + partB_gptsb8 + partB_gptsb9 +
partB_gpts10'
colnames(d)[1] = 'PartA_gptsa1'
model_fit = cfa(model, data = d, estimator = "WLSMV", std.lv=TRUE, missing = "listwise")
summary(model_fit,standardized=T, fit.measures = T)
d3
d2
d2 = d2 %>%
mutate_at(vars(1:18),
~factor(recode(.,
"1"=0,
"2"=1,
"3"=2,
"4"=3,
"5"=4)),ordered=T)
d3 = d3 %>%
mutate_at(vars(1:18),
~factor(recode(.,
"1"=0,
"2"=1,
"3"=2,
"4"=3,
"5"=4)),ordered=T)
d3
d = rbind(d1,d2)
d = rbind(d,d3)
model = 'reference =~ PartA_gptsa1 + PartA_gptsa2 +PartA_gptsa3 + PartA_gptsa4 +
PartA_gptsa5 + PartA_gptsa6 + PartA_gptsa7 + PartA_gptsa8
persecutory =~ partB_gptsb1 + partB_gptsb2 + partB_gptsb3 + partB_gptsb4 +
partB_gptsb5 + partB_gptsb6 + partB_gptsb7 + partB_gptsb8 + partB_gptsb9 +
partB_gpts10'
colnames(d)[1] = 'PartA_gptsa1'
model_fit = cfa(model, data = d, estimator = "WLSMV", std.lv=TRUE, missing = "listwise")
fitmeasures(new_fit1,c('chisq.scaled', 'df.scaled', 'chisq.scaling.factor'))
summary(model_fit,standardized=T, fit.measures = T)
model_fit = cfa(model, data = d, estimator = "MLR", std.lv=TRUE, missing = "listwise")
summary(model_fit,standardized=T, fit.measures = T)
model_fit = cfa(model, data = d, estimator = "WLSMV", std.lv=TRUE, missing = "pairwise")
summary(model_fit,standardized=T, fit.measures = T)
setwd("f:/projekty/Joachim/PQ16")
d <- read.csv("PQ16.csv", sep=",", header =T)
library(lavaan)
d <- read.csv("IVI.csv", sep=",", header =T)
setwd("f:/projekty/Joachim/IVI")
d <- read.csv("IVI.csv", sep=",", header =T)
colnames(d)[1] = 'IVI_1'
model_fit = cfa(model, data = d, estimator = "WLSMV", std.lv=TRUE, missing = "listwise")
model = 'metaphysical =~ IVI_1 + IVI_3 + IVI_4 + IVI_5 + IVI_6 + IVI_8 + IVI_13 +
IVI_14 + IVI_15 + IVI_16 + IVI_17 + IVI_22 + IVI_25 + IVI_26
positive =~ IVI_2 + IVI_7 + IVI_9 +IVI_18 +IVI_19 +IVI_20 +IVI_21 +IVI_24
loss_of_control =~ IVI_10 +IVI_11 +IVI_12 +IVI_22 +IVI_23'
model_fit = cfa(model, data = d, estimator = "WLSMV", std.lv=TRUE, missing = "listwise")
summary(model_fit,standardized=T, fit.measures = T)
model = 'metaphysical =~ IVI_1 + IVI_3 + IVI_4 + IVI_5 + IVI_6 + IVI_8 + IVI_13 +
IVI_14 + IVI_15 + IVI_16 + IVI_17 + IVI_25 + IVI_26
positive =~ IVI_2 + IVI_7 + IVI_9 +IVI_18 +IVI_19 +IVI_20 +IVI_21 +IVI_24
loss_of_control =~ IVI_10 +IVI_11 +IVI_12 +IVI_22 +IVI_23'
model_fit = cfa(model, data = d, estimator = "WLSMV", std.lv=TRUE, missing = "listwise")
summary(model_fit,standardized=T, fit.measures = T)
iclust (d)
library(psych)
iclust (d)
new_model = 'positive =~ IVI_21 + IVI_20 + IVI_24 + IVI_19 + IVI_2 + IVI_7 + IVI_17 +
IVI_18 + IVI_9 + IVI_8 + IVI_13 + IVI_5
negative =~ IVI_25 + IVI_16 + IVI_26 +IVI_14 +IVI_1 +IVI_6 + IVI_4 + IVI_11 +
IVI_4 +IVI_23 +IVI_22 +IVI_15 +IVI_12'
new_model = 'positive =~ IVI_21 + IVI_20 + IVI_24 + IVI_19 + IVI_2 + IVI_7 + IVI_17 +
IVI_18 + IVI_9 + IVI_8 + IVI_13 + IVI_5
negative =~ IVI_25 + IVI_16 + IVI_26 +IVI_14 +IVI_1 +IVI_6 + IVI_4 + IVI_11 +
IVI_4 +IVI_23 +IVI_22 +IVI_15 +IVI_12 + IVI_3'
model_fit = cfa(new_model, data = d, estimator = "WLSMV", std.lv=TRUE, missing = "listwise")
summary(model_fit,standardized=T, fit.measures = T)
new_model = 'positive =~ IVI_21 + IVI_20 + IVI_24 + IVI_19 + IVI_2 + IVI_7 +
IVI_18 + IVI_9 + IVI_8
negative =~ IVI_25 + IVI_16 + IVI_26 +IVI_14 +IVI_1 +IVI_6 + IVI_4 + IVI_11 +
IVI_4 +IVI_23 +IVI_22 +IVI_15 +IVI_12 + IVI_3'
model_fit = cfa(new_model, data = d, estimator = "WLSMV", std.lv=TRUE, missing = "listwise")
summary(model_fit,standardized=T, fit.measures = T)
positive = d[,c('IVI_21')]
positive = d[c('IVI_21'),]
View(positive)
positive = d[,c('IVI_21')]
positive = subset(d , colnames(d) == c('IVI21' , 'IVI_20','IVI_24','IVI_19','IVI_2','IVI_7', 'IVI_17', 'IVI_18','IVI_9','IVI_8','IVI_5','IVI_13'))
positive = d [,c('IVI21' , 'IVI_20','IVI_24','IVI_19','IVI_2','IVI_7', 'IVI_17', 'IVI_18','IVI_9','IVI_8','IVI_5','IVI_13')]
positive = d [c('IVI21' , 'IVI_20','IVI_24','IVI_19','IVI_2','IVI_7', 'IVI_17', 'IVI_18','IVI_9','IVI_8','IVI_5','IVI_13')]
positive = d [c('IVI21' , 'IVI_20','IVI_24','IVI_19','IVI_2','IVI_7', 'IVI_17', 'IVI_18','IVI_9','IVI_8','IVI_5','IVI_13')]
d [c('IVI21' , 'IVI_20','IVI_24','IVI_19','IVI_2','IVI_7', 'IVI_17', 'IVI_18','IVI_9','IVI_8','IVI_5','IVI_13')]
d
d [c=('IVI21' , 'IVI_20','IVI_24','IVI_19','IVI_2','IVI_7', 'IVI_17', 'IVI_18','IVI_9','IVI_8','IVI_5','IVI_13')]
c('IVI21' , 'IVI_20','IVI_24','IVI_19','IVI_2','IVI_7', 'IVI_17', 'IVI_18','IVI_9','IVI_8','IVI_5','IVI_13')]
c('IVI21' , 'IVI_20','IVI_24','IVI_19','IVI_2','IVI_7', 'IVI_17', 'IVI_18','IVI_9','IVI_8','IVI_5','IVI_13')
positive = d[,c('IVI21' , 'IVI_20','IVI_24','IVI_19','IVI_2','IVI_7', 'IVI_17', 'IVI_18','IVI_9','IVI_8','IVI_5','IVI_13')]
positive = d[c('IVI21','IVI_20','IVI_24','IVI_19','IVI_2','IVI_7', 'IVI_17', 'IVI_18','IVI_9','IVI_8','IVI_5','IVI_13')]
positive = d[c('IVI_21','IVI_20','IVI_24','IVI_19','IVI_2','IVI_7', 'IVI_17', 'IVI_18','IVI_9','IVI_8','IVI_5','IVI_13')]
View(positive)
alpha(positive)
omega(positive)
omega(d)
negative = d[c('IVI_25','IVI_16','IVI_26','IVI_14','IVI_1','IVI_6', 'IVI_4', 'IVI_23','IVI_22','IVI_15','IVI_12','IVI_3')]
alpha(negative)
iclust (d)
